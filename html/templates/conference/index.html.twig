{% extends 'base.html.twig' %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('/css/conference.css') }}">{% endblock %}

{% block title %}{{ conference.title }}{% endblock %}

{% block body %}
    <div class="container">
        <div>
            <h1 class="mb-4">{{ conference.title }} <span id="rate"></span></h1>
            <div class="d-flex bd-highlight justify-content-between mb-3">
                {{ rating.nmbUser }} personnes on voté
                <div>{{ conference.date | date }}</div>
                {% if conference.address is not null %}
                    <div>{{ conference.address }}</div>
                {% else %}
                    <div>Le lieu n'est pas encore définis...</div>
                {% endif %}
            </div>
            {% if conference.image is not null %}
                <div class="floated">
                    <img src="{{ asset('/images/' ~ conference.image )}}"/>
                </div>
            {% endif %}
            <p>{{ conference.content }}</p>
        </div>
        <div>
            {% for vote in votes %}
                <div class="row">
                    <span id="{{ vote.id }}"></span>
                  {{ vote.comment }}
               </div>
            {% endfor %}
            {% if form is defined %}
            {{ form_start(form, {'attr': {'class':'col-lg-4 offset-lg-4'}}) }}
            {{ form_row(form.rating, {'attr':{'class':'form-control'}}) }}
            {{ form_row(form.comment, {'attr':{'class':'form-control'}}) }}
            {{ form_row(form.submit, {'attr': {'class': 'btn btn-outline-success'}}) }}
            {{ form_end(form) }}
            {% endif %}
        </div>
    </div>
{% endblock %}
{% block javascripts %}
<script>
    function generate_star_rating(rate, name_of_id,){
        var entier = Math.trunc(rate);
        var decimal = rate - entier;

        var content = "";
        for (var i = 1; i<= entier; i++){
            content = content+"<i class='fas fa-star' style='color:#c8071a'></i>"
        }
        if (entier < 5){
            if (decimal <0.25){
                content = content+"<i class='far fa-star' style='color:grey'></i>"
            }
            if (decimal <0.75 && decimal >= 0.25){
                content = content+"<i class='fas fa-star-half-alt' style='color:#c8071a'></i>"
            }
            if (decimal >= 0.75){
                content = content+"<i class='fas fa-star' style='color:#c8071a'></i>"
            }
        }
        for (var i = 1; i< 5 - entier; i++){
            content = content+"<i class='far fa-star' style='color:grey'></i>"
        }
        document.getElementById(name_of_id).innerHTML=content;

    };

generate_star_rating({{ rating.rating }}, 'rate')
{% for vote in votes %}
    generate_star_rating({{ vote.rating }}, {{ vote.id }})
{% endfor %}
</script>
{% endblock %}